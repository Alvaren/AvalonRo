// Script for PvP System. Author: Sebastian ≈Åasisz.
// AvalonRO

-	script	PVPreward	-1,{
	OnPCKillEvent:
		set .@killer, getcharid(3);
		set .@victim, killerdid;

		dispbottom killedrid;
		dispbottom last_kill;
		set $@klvl, BaseLevel;
		attachrid(.@victim);
		set $@vlvl, BaseLevel;
		attachrid(.@killer);
		if (.@victim != last_kill && .@victim != getcharid(3) && $@klvl == $@vlvl) {
			getmapxy (.@map$, .@x, .@y, 0);
			if( .@map$ == "pvp_y_1-2" ){
				set .@random, rand(1,100);
				if(.@random < 30){
					getitem 640, 1;
				}
			}
			//if event map, random = 100;
			//if pvp arena, random = 30;
			//otherwise, random = 10;
		}
		set last_kill, .@victim;
		end;
}

prontera,150,150,6	script	Frank	52,{
	mes "[Frank]";
	mes "You call me dispeller, but maybe my name is Frank?";
	undisguise;
	sc_end SC_ALL;
	close;
	end;
}

prontera,155,155,6	script	Tom	52,{
	mes "[Tom]";
	mes "Hello. I'm Tom and I'm Jette's helper";
	mes "I will decide if you are eligble to join this event.";
	mes "You better have your gear prepared properly!";
	next;

	//GENERAL RESTRICIONS INC

	//consumable items except holy water;
	for( set .@i, 501; .@i <= 599; set .@i, .@i +1 ){
		if(countitem(.@i) > 0 && .@i != 523){
			mes "[Tom]";
			mes "YOU ARE NOT PREPARED!!";
			mes "Get rid of your consumables and talk to me again.";
			close;
		}
	}
	//berry and seed
	if(countitem(607) > 0 || countitem(608) > 0){
		mes "[Tom]";
		mes "Duuude... berries? seeds? Get rid of them now!";
		mes "When you are ready talk to me again.";
		close;
	}
	//scrolls
	if(countitem(4850) > 0 || countitem(4851) > 0 || countitem(13541) > 0 || countitem(14515) > 0 || countitem(6192) > 0 || countitem(13539) > 0 || countitem(14513) > 0 || countitem(282238) > 0){
		mes "[Tom]";
		mes "You cannot bring that items to the event";
		close;
	}
	//god items: asprika, brynhild, mjolnir
	if(countitem(2541) > 0 || countitem(2382) > 0 || countitem(1530) > 0){
		mes "[Tom]";
		mes "Nice try, but ... YOU ARE NOT PREPARED!!";
		mes "Drop your god items to storage and talk to me.";
		close;
	}
	//MvP Cards
	if(countitem(4128) > 0 || checkequipedcard(4128) || countitem(4276) > 0 || checkequipedcard(4276) || countitem(4361) > 0 || checkequipedcard(4361)){
		mes "[Tom]";
		mes "YOU ARE NOT PREPARED!!";
		mes "Well... you've got either LoD, GTB or WS card...";
		mes "Visit me when you store them all.";
		close;
	}
	//coma items
	if(countitem(1132) > 0 || countitem(1565) > 0 || countitem(1369) > 0 || countitem(1141) > 0){
		mes "[Tom]";
		mes "You cannot bring coma items with you.";
		mes "Talk to me when you'll get rid of them.";
		close;
	}

	mes "[GTB Check]";
	
	close;
	end;
}